services:
  # Backend
  job-clea-data-scraping: &job-clea-data-scraping
    container_name: job-clea-data-scraping
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ${PWD}:/app
      - job-clea-venv:/app/.venv
    working_dir: /app
    # Runs main.py directly (same as Cloud Run Jobs)
    # Remove this line if you want to use the default CMD from Dockerfile
    # command: uv run python main.py

    networks:
      - menteru-net

    # 環境変数（必要に応じて追加）
    # env_file:
    #   - .env
    ports:
      - "8080:8080"

    restart: "no"
    environment:
      # 開発環境変数
      - PYTHONDONTWRITEBYTECODE=1
      - PYTHONUNBUFFERED=1
      - LOCAL_DATA_ROOT=/app/data
      - PROJECT_ID=airux8-opti-logic
      - BUCKET_NAME=airux8-opti-logic-prod
      - GOOGLE_APPLICATION_CREDENTIALS=/app/config/job-clea-data-scraping-sa.json

volumes:
  job-clea-venv:

networks:
  menteru-net:
    driver: bridge
